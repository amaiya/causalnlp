---

title: Metalearner Sensitivity


keywords: fastai
sidebar: home_sidebar

summary: "Metalearner Sensitivity"
description: "Metalearner Sensitivity"
nb_path: "nbs/05i_meta.sensitivity.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/05i_meta.sensitivity.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="one_sided" class="doc_header"><code>one_sided</code><a href="https://github.com/amaiya/causalnlp/tree/main/causalnlp/meta/sensitivity.py#L35" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>one_sided</code>(<strong><code>alpha</code></strong>, <strong><code>p</code></strong>, <strong><code>treatment</code></strong>)</p>
</blockquote>
<p>One sided confounding function.
Reference:  Blackwell, Matthew. "A selection bias approach to sensitivity analysis
for causal effects." Political Analysis 22.2 (2014): 169-182.
<a href="https://www.mattblackwell.org/files/papers/causalsens.pdf">https://www.mattblackwell.org/files/papers/causalsens.pdf</a></p>
<p>Args:
    alpha (np.array): a confounding values vector
    p (np.array): a propensity score vector between 0 and 1
    treatment (np.array): a treatment vector (1 if treated, otherwise 0)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="alignment" class="doc_header"><code>alignment</code><a href="https://github.com/amaiya/causalnlp/tree/main/causalnlp/meta/sensitivity.py#L51" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>alignment</code>(<strong><code>alpha</code></strong>, <strong><code>p</code></strong>, <strong><code>treatment</code></strong>)</p>
</blockquote>
<p>Alignment confounding function.
Reference:  Blackwell, Matthew. "A selection bias approach to sensitivity analysis
for causal effects." Political Analysis 22.2 (2014): 169-182.
<a href="https://www.mattblackwell.org/files/papers/causalsens.pdf">https://www.mattblackwell.org/files/papers/causalsens.pdf</a></p>
<p>Args:
    alpha (np.array): a confounding values vector
    p (np.array): a propensity score vector between 0 and 1
    treatment (np.array): a treatment vector (1 if treated, otherwise 0)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="one_sided_att" class="doc_header"><code>one_sided_att</code><a href="https://github.com/amaiya/causalnlp/tree/main/causalnlp/meta/sensitivity.py#L68" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>one_sided_att</code>(<strong><code>alpha</code></strong>, <strong><code>p</code></strong>, <strong><code>treatment</code></strong>)</p>
</blockquote>
<p>One sided confounding function for the average effect of the treatment among the treated units (ATT)</p>
<p>Reference:  Blackwell, Matthew. "A selection bias approach to sensitivity analysis
for causal effects." Political Analysis 22.2 (2014): 169-182.
<a href="https://www.mattblackwell.org/files/papers/causalsens.pdf">https://www.mattblackwell.org/files/papers/causalsens.pdf</a></p>
<p>Args:
    alpha (np.array): a confounding values vector
    p (np.array): a propensity score vector between 0 and 1
    treatment (np.array): a treatment vector (1 if treated, otherwise 0)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="alignment_att" class="doc_header"><code>alignment_att</code><a href="https://github.com/amaiya/causalnlp/tree/main/causalnlp/meta/sensitivity.py#L85" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>alignment_att</code>(<strong><code>alpha</code></strong>, <strong><code>p</code></strong>, <strong><code>treatment</code></strong>)</p>
</blockquote>
<p>Alignment confounding function for the average effect of the treatment among the treated units (ATT)</p>
<p>Reference:  Blackwell, Matthew. "A selection bias approach to sensitivity analysis
for causal effects." Political Analysis 22.2 (2014): 169-182.
<a href="https://www.mattblackwell.org/files/papers/causalsens.pdf">https://www.mattblackwell.org/files/papers/causalsens.pdf</a></p>
<p>Args:
    alpha (np.array): a confounding values vector
    p (np.array): a propensity score vector between 0 and 1
    treatment (np.array): a treatment vector (1 if treated, otherwise 0)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Sensitivity" class="doc_header"><code>class</code> <code>Sensitivity</code><a href="https://github.com/amaiya/causalnlp/tree/main/causalnlp/meta/sensitivity.py#L102" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Sensitivity</code>(<strong><code>df</code></strong>, <strong><code>inference_features</code></strong>, <strong><code>p_col</code></strong>, <strong><code>treatment_col</code></strong>, <strong><code>outcome_col</code></strong>, <strong><code>learner</code></strong>, <strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>A Sensitivity Check class to support Placebo Treatment, Irrelevant Additional Confounder
and Subset validation refutation methods to verify causal inference.</p>
<p>Reference: <a href="https://github.com/microsoft/dowhy/blob/master/dowhy/causal_refuters/">https://github.com/microsoft/dowhy/blob/master/dowhy/causal_refuters/</a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SensitivityPlaceboTreatment" class="doc_header"><code>class</code> <code>SensitivityPlaceboTreatment</code><a href="https://github.com/amaiya/causalnlp/tree/main/causalnlp/meta/sensitivity.py#L259" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SensitivityPlaceboTreatment</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>) :: <a href="/causalnlp/meta.sensitivity.html#Sensitivity"><code>Sensitivity</code></a></p>
</blockquote>
<p>Replaces the treatment variable with a new variable randomly generated.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SensitivityRandomCause" class="doc_header"><code>class</code> <code>SensitivityRandomCause</code><a href="https://github.com/amaiya/causalnlp/tree/main/causalnlp/meta/sensitivity.py#L285" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SensitivityRandomCause</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>) :: <a href="/causalnlp/meta.sensitivity.html#Sensitivity"><code>Sensitivity</code></a></p>
</blockquote>
<p>Adds an irrelevant random covariate to the dataframe.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SensitivityRandomReplace" class="doc_header"><code>class</code> <code>SensitivityRandomReplace</code><a href="https://github.com/amaiya/causalnlp/tree/main/causalnlp/meta/sensitivity.py#L306" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SensitivityRandomReplace</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>) :: <a href="/causalnlp/meta.sensitivity.html#Sensitivity"><code>Sensitivity</code></a></p>
</blockquote>
<p>Replaces a random covariate with an irrelevant variable.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SensitivitySubsetData" class="doc_header"><code>class</code> <code>SensitivitySubsetData</code><a href="https://github.com/amaiya/causalnlp/tree/main/causalnlp/meta/sensitivity.py#L336" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SensitivitySubsetData</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>) :: <a href="/causalnlp/meta.sensitivity.html#Sensitivity"><code>Sensitivity</code></a></p>
</blockquote>
<p>Takes a random subset of size sample_size of the data.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SensitivitySelectionBias" class="doc_header"><code>class</code> <code>SensitivitySelectionBias</code><a href="https://github.com/amaiya/causalnlp/tree/main/causalnlp/meta/sensitivity.py#L357" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SensitivitySelectionBias</code>(<strong>*<code>args</code></strong>, <strong><code>confound</code></strong>=<em><code>'one_sided'</code></em>, <strong><code>alpha_range</code></strong>=<em><code>None</code></em>, <strong><code>sensitivity_features</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/causalnlp/meta.sensitivity.html#Sensitivity"><code>Sensitivity</code></a></p>
</blockquote>
<p>Reference:</p>
<p>[1] Blackwell, Matthew. "A selection bias approach to sensitivity analysis
for causal effects." Political Analysis 22.2 (2014): 169-182.
<a href="https://www.mattblackwell.org/files/papers/causalsens.pdf">https://www.mattblackwell.org/files/papers/causalsens.pdf</a></p>
<p>[2] Confouding parameter alpha_range using the same range as in:
<a href="https://github.com/mattblackwell/causalsens/blob/master/R/causalsens.R">https://github.com/mattblackwell/causalsens/blob/master/R/causalsens.R</a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>


